{ lib, pkgs, config, ... }:
with lib;
let cfg = config.link.pentesting;
in {
  options.link.pentesting.enable = mkEnableOption "activate pentesting";
  config = mkIf cfg.enable {
    home.packages = with pkgs; [
      p0f # Passive network reconnaissance and fingerprinting tool
      nmap
      rustscan # rust nmap alternative
      zmap
      crackmapexec # Swiss army knife for pentesting networks
      netdiscover
      arp-scan
      amass # DNS Enumeration and Network Mapping
      dirb
      gobuster
      ## DNS
      dnsrecon
      dnsenum
      dnstracer
      certgraph # crawl the graph of certificate alternate names
      ## SMB
      smbmap # SMB enumeration tool
      # Network
      metasploit
      testssl
      routersploit
      dsniff
      thc-hydra
      ncrack # Network authentication tool
      gotestwaf # API and OWASP attack simulation
      sshchecker # ssh brute force
      snmpcheck # snmp enumerator
      sqlmap # sql injection
      xsser # XSS
      exploitdb # Public exploit archive
      log4jcheck
      lmp # log4j, test both
      osv-scanner # scanner for osv.dev vuln db
      commix # Command Injection
      ## MITM
      bettercap
      ettercap
      mitmproxy
      mitmproxy2swagger # for REST APIs
      websploit
      ssh-mitm
      dnschef
      # kube-hunter # Kubernetes
      ## Interaction
      inetutils # Telnet, tracroute
      dig
      ## Sniffing
      wireshark
      #netsniff-ng
      # Web
      wget
      curl
      burpsuite
      nur.repos.wolfangaukang.burpsuite-pro
      zap
      nikto # noisy web app scanner
      whatweb # Web scanner
      wapiti # web app vuln scanner
      wpscan # wordpress
      wprecon # wordpress
      wafw00f # identify and fingerprint Web Application Firewalls (WAF)
      crlfuzz # CRLF
      # postman # API
      # Cracking
      crunch # generate wordlist
      cewl # generate custom wordlist
      john
      hashcat
      # Social Engineering
      social-engineer-toolkit
      #deepsea # Phishing # broken
      # WLAN
      aircrack-ng
      airgeddon # TUI for automating aircrack
      wifite2
      hostapd
      #dhcp
      lighttpd
      # dnsmasq
      #? beef
      ## SDR
      # hackrf
      # urh
      # Android
      android-tools
      android-studio
      #ghost # Android post-exploitation framework
      # Cryptography
      cyberchef
      stegseek # crack steganography
      steghide # steganography
      # OSINT
      theharvester # Gather E-mails, subdomains and names from different public sources
      octosuite # Github
      # git-hound # broken
      sn0int
      metabigor
      asn # network data
      # Dorks
      go-dork
      # Reversing
      ghidra
      pwndbg
      # cutter
      ## Bug finder
      #findbugs # java
      #brakeman # ruby on rails
      #bandit # python
      #cppcheck # C,C++
      #cve-bin-tool binary
      # regexploit # regex DOS scanner
      ## Android
      apktool
    ];
  };
}
