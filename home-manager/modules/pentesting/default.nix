{ lib, pkgs, config, flake-self, ... }:
with lib;
let cfg = config.link.pentesting;
in {
  options.link.pentesting.enable = mkEnableOption "activate pentesting";
  config = mkIf cfg.enable {
    home.packages = with pkgs; [
      ## OSINT
      ### DNS
      ### Cert History
      ### WhoisQ
      proxychains-ng
      python312Packages.impacket
      amass # DNS Enumeration and Network Mapping
      dig
      dnsx
      subfinder
      gowitness # Screenshot websites
      cvemap
      katana # crawl/ spider
      uncover
      proxify
      interactsh
      mapcidr
      tlsx
      cdncheck
      cloudlist
      alterx
      asnmap
      urlfinder # passive
      whois
      dnsrecon
      dnstracer
      certgraph # crawl the graph of certificate alternate names
      ### OSINT Brute Force
      dnsenum
      ## Interaction
      # httpx # broken
      socat # better netcat
      netcat-openbsd
      ## Scan
      ### Port
      nmap
      naabu # nmap plus extras
      rustscan # rust nmap alternative
      zmap # VERY fast network scanner
      zgrab2 # zmap with more details per host
      ### SSL/TLS
      ### HTTP Discovery
      dirb
      gobuster
      gau # passive url discovery
      ## Vuln
      ### Scan
      vulnix
      ### CVE
      ### Local
      netdiscover
      arp-scan
      ## MISC
      bruno # FOSS Postman
      legba # general purpose brute forcer/ enumerator
      nvdtools
      responder
      caido # web framework
      # clairvoyance # broken # graphql schema obtainer
      unicode-paracode
      rustscan
      angryipscanner
      cvemap
      go-dork
      zgrab2
      macchanger
      # wordlists
      # xxd
      tcpdump
      inetutils # telnet
      p0f # Passive network reconnaissance and fingerprinting tool
      netexec # Swiss army knife for pentesting networks, previously crackmapexec # broken
      ## DNS
      ## SMB
      smbmap # SMB enumeration tool
      # Network
      metasploit
      testssl
      # routersploit
      # dsniff
      thc-hydra # simple login cracker
      # ncrack # broken # Network authentication tool
      gotestwaf # API and OWASP attack simulation
      sshchecker # ssh brute force
      ssh-audit
      snmpcheck # snmp enumerator
      sqlmap # sql injection
      # xsser # XSS # broken 240721
      dalfox # alternative to xsser
      exploitdb # Public exploit archive
      log4jcheck
      lmp # log4j, test both
      osv-scanner # scanner for osv.dev vuln db
      commix # Command Injection
      ## MITM
      bettercap
      ettercap
      mitmproxy
      # mitmproxy2swagger # for REST APIs
      websploit
      # ssh-mitm
      dnschef
      ## Active Directory
      # adreaper
      # silenthound
      # adalanche
      # lil-pwny # Offline auditing of Active Directory passwords
      # knowsmore
      # bloodhound
      # autobloody
      # ad-miner
      # kube-hunter # Kubernetes
      ## Interaction
      iputils # Telnet, tracroute
      # https://github.com/projectdiscovery/wappalyzergo
      # https://github.com/projectdiscovery/shuffledns
      ## Sniffing
      wireshark
      #netsniff-ng
      # Web
      wget
      curl
      chromium
      (burpsuite.override { proEdition = false; }) # .overrideAttrs
      #{ targetPkgs =  [ pkgs.mesa ]; })
      zap
      nikto # noisy web app scanner
      nuclei
      nuclei-templates
      whatweb # Web scanner
      # wapiti # web app vuln scanner # broken
      wpscan # wordpress
      wprecon # wordpress
      wafw00f # identify and fingerprint Web Application Firewalls (WAF)
      waf-tester
      crlfuzz # CRLF
      ffuf # web fuzzer
      # postman # API
      # Cracking
      crunch # generate wordlist
      # cewl # broken # generate custom wordlist
      # john # broken
      # johnny # john the ripper GUI
      hashcat
      # Social Engineering
      social-engineer-toolkit
      #deepsea # Phishing # broken
      # WLAN
      wavemon # general wifi monitoring tool
      aircrack-ng
      airgeddon # TUI for automating aircrack
      hcxtools # cap->hash
      hcxdumptool
      # wifite2 # broken
      hostapd
      #dhcp
      lighttpd
      httprobe
      httpie
      xh # better curl, better httpie
      # dnsmasq
      #? beef
      ## SDR
      sdrpp
      hackrf
      urh # universal-radio-hacker
      # qradiolink
      sdrangel
      gnuradio
      kalibrate-hackrf
      gqrx-gr-audio
      # Android
      # android-tools
      # android-studio
      #ghost # Android post-exploitation framework
      # Cryptography
      cyberchef
      # stegseek # crack steganography
      # steghide # steganography
      # OSINT
      # theharvester # Gather E-mails, subdomains and names from different public sources # broken
      octosuite # Github
      # git-hound # broken
      sn0int
      metabigor # OSINT Tool for IPs/ ASN/ Whois data, doesnt always work
      asn # network ASN data with traceroute
      thc-ipv6 # Paket crafter and flooder
      # Dorks
      go-dork
      # Reversing
      pwntools
      ghidra
      ghidra-extensions.machinelearning
      ghidra-extensions.gnudisassembler
      ghidra-extensions.ghidraninja-ghidra-scripts
      cutterPlugins.rz-ghidra
      flake-self.inputs.pwndbg.packages.${pkgs.system}.default
      cutter
      cutterPlugins.sigdb
      ## Bug finder
      # dependency-track # Library/ Dependency Vurnerability checker
      #findbugs # java
      #brakeman # ruby on rails
      #bandit # python
      #cppcheck # C,C++
      #cve-bin-tool binary
      # regexploit # regex DOS scanner
      ## Android
      # apktool
    ];
  };
}
